# DENCOã‚·ã‚¹ãƒ†ãƒ  - 3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€DENCOã‚·ã‚¹ãƒ†ãƒ ã®3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ãŠã‘ã‚‹å„å±¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã‚’èª¬æ˜ã—ã¾ã™ã€‚

## æ¦‚è¦

DENCOã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®3å±¤ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **ğŸŸ¢ Node.js Backend (Asteriskçµ±åˆå±¤)** - Port 3001
2. **ğŸ Python Backend (AIå‡¦ç†å±¤)** - Port 8000
3. **âš›ï¸ Next.js Frontend (UIå±¤)** - Port 3000

## 1. ğŸŸ¢ Node.js Backend (Asteriskçµ±åˆå±¤)

### é…ç½®å ´æ‰€
```
asterisk-backend/
```

### è²¬å‹™
- Asterisk PBXã¨ã®é€šä¿¡ï¼ˆARIçµŒç”±ï¼‰
- é€šè©±åˆ¶å¾¡ã¨ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- WebSocketã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ç®¡ç†
- Python Backendã¨Frontendã®æ©‹æ¸¡ã—

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
asterisk-backend/
â”œâ”€â”€ server.js                    # Expressã‚µãƒ¼ãƒãƒ¼ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ ari-client.js                # Asterisk ARIæ¥ç¶šç®¡ç†
â”œâ”€â”€ call-handler.js              # é€šè©±åˆ¶å¾¡ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ websocket-manager.js         # WebSocketé€šä¿¡ç®¡ç†ï¼ˆPython/Frontendï¼‰
â”œâ”€â”€ config.js                    # è¨­å®šç®¡ç†
â”œâ”€â”€ logger.js                    # ãƒ­ã‚°æ©Ÿèƒ½
â”œâ”€â”€ package.json                 # Node.jsä¾å­˜é–¢ä¿‚
â”œâ”€â”€ package-lock.json            # ä¾å­˜é–¢ä¿‚ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ env.template                 # ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ .env                         # ç’°å¢ƒå¤‰æ•°ï¼ˆå®Ÿéš›ã®è¨­å®šï¼‰
â”œâ”€â”€ .gitignore                   # Gité™¤å¤–è¨­å®š
â””â”€â”€ README.md                    # Node.js Backendè©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

### ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|---------|------|
| `server.js` | Expressã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã€ãƒ«ãƒ¼ãƒˆå®šç¾©ã€WebSocketã‚µãƒ¼ãƒãƒ¼åˆæœŸåŒ– |
| `ari-client.js` | ARIæ¥ç¶šç¢ºç«‹ã€å†æ¥ç¶šå‡¦ç†ã€ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­ |
| `call-handler.js` | ç€ä¿¡ãƒ»ç™ºä¿¡å‡¦ç†ã€é€šè©±çŠ¶æ…‹ç®¡ç†ã€Stasisã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ |
| `websocket-manager.js` | Python Backendã¨ã®WebSocketé€šä¿¡ã€Frontendé€šçŸ¥ç®¡ç† |
| `config.js` | ç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿ã€è¨­å®šå€¤ç®¡ç† |
| `logger.js` | æ§‹é€ åŒ–ãƒ­ã‚°å‡ºåŠ›ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ç®¡ç† |

### èµ·å‹•æ–¹æ³•

```bash
cd asterisk-backend
npm install
npm run dev
```

### ç’°å¢ƒå¤‰æ•° (`.env`)

```env
# Asterisk ARIè¨­å®š
ASTERISK_HOST=192.168.1.100
ASTERISK_ARI_PORT=8088
ASTERISK_ARI_USERNAME=ariuser
ASTERISK_ARI_PASSWORD=arisecret
ASTERISK_APP_NAME=denco_voiceai

# Python Backendé€£æº
PYTHON_BACKEND_URL=http://localhost:8000
PYTHON_BACKEND_WS_URL=ws://localhost:8000
BACKEND_AUTH_TOKEN=your-secure-token

# ã‚µãƒ¼ãƒãƒ¼è¨­å®š
NODE_SERVER_PORT=3001
NODE_SERVER_HOST=0.0.0.0
```

### ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

```json
{
  "dependencies": {
    "ari-client": "^2.2.0",      // Asterisk ARI ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    "axios": "^1.6.0",           // HTTPé€šä¿¡
    "dotenv": "^16.3.1",         // ç’°å¢ƒå¤‰æ•°ç®¡ç†
    "express": "^4.18.2",        // Webã‚µãƒ¼ãƒãƒ¼
    "ws": "^8.14.2",             // WebSocketã‚µãƒ¼ãƒãƒ¼
    "uuid": "^9.0.1",            // UUIDç”Ÿæˆ
    "form-data": "^4.0.0"        // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å‡¦ç†
  }
}
```

---

## 2. ğŸ Python Backend (AIå‡¦ç†å±¤)

### é…ç½®å ´æ‰€
```
/ (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ)
api/ (APIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
```

### è²¬å‹™
- AIéŸ³å£°å‡¦ç†ï¼ˆAzure Speech Servicesï¼‰
- å¯¾è©±AIåˆ¶å¾¡ï¼ˆDify AIï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ï¼ˆPostgreSQLï¼‰
- FAXå‡¦ç†ãƒ»OCR
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
- REST APIæä¾›

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
/ (ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)
â”œâ”€â”€ main.py                      # FastAPIãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ database.py                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ»ã‚¯ã‚¨ãƒªç®¡ç†
â”œâ”€â”€ database_extensions.py       # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰
â”œâ”€â”€ models.py                    # Pydanticãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©
â”œâ”€â”€ auth.py                      # èªè¨¼ãƒ»èªå¯å‡¦ç†
â”œâ”€â”€ vad.py                       # éŸ³å£°æ´»å‹•æ¤œå‡ºï¼ˆSilero VADï¼‰
â”œâ”€â”€ dify_client.py               # Dify AIçµ±åˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ setup_db.py                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ reset_db.py                  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ requirements.txt             # Pythonä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”œâ”€â”€ .env                         # ç’°å¢ƒå¤‰æ•°ï¼ˆDBã€Azureã€Difyè¨­å®šï¼‰
â”‚
â””â”€â”€ api/                         # APIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆFastAPIãƒ«ãƒ¼ã‚¿ãƒ¼ï¼‰
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ customers.py             # é¡§å®¢ç®¡ç†API
    â”œâ”€â”€ knowledge.py             # ãƒŠãƒ¬ãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹API
    â”œâ”€â”€ campaigns.py             # AIæ¶é›»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³API
    â”œâ”€â”€ settings.py              # ã‚·ã‚¹ãƒ†ãƒ è¨­å®šAPI
    â”œâ”€â”€ tags.py                  # ã‚¿ã‚°ç®¡ç†API
    â””â”€â”€ tenants.py               # ãƒ†ãƒŠãƒ³ãƒˆç®¡ç†API
```

### ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|---------|------|
| `main.py` | FastAPIã‚¢ãƒ—ãƒªåˆæœŸåŒ–ã€CORSè¨­å®šã€WebSocketã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€APIãƒ«ãƒ¼ã‚¿ãƒ¼çµ±åˆ |
| `database.py` | PostgreSQLæ¥ç¶šãƒ—ãƒ¼ãƒ«ã€å…¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç† |
| `database_extensions.py` | æ‹¡å¼µãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œï¼ˆçµ±è¨ˆã€æ¤œç´¢ã€é›†è¨ˆï¼‰ |
| `models.py` | Pydanticãƒ¢ãƒ‡ãƒ«ï¼ˆCallSession, Customer, FaxDocumentç­‰ï¼‰ |
| `auth.py` | Bearer Tokenèªè¨¼ã€ãƒ†ãƒŠãƒ³ãƒˆIDæ¤œè¨¼ |
| `vad.py` | Silero VADã«ã‚ˆã‚‹éŸ³å£°æ´»å‹•æ¤œå‡º |
| `dify_client.py` | Dify APIã¨ã®é€šä¿¡ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ |

### APIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | æ©Ÿèƒ½ |
|-----------|--------------|------|
| `customers.py` | `/api/customers/*` | é¡§å®¢CRUDã€æ¤œç´¢ã€é€šè©±å±¥æ­´ |
| `knowledge.py` | `/api/knowledge/*` | ãƒŠãƒ¬ãƒƒã‚¸è¨˜äº‹ã€ãŠå•ã„åˆã‚ã›ã€ã‚«ãƒ†ã‚´ãƒªãƒ¼ç®¡ç† |
| `campaigns.py` | `/api/campaigns/*` | AIæ¶é›»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç† |
| `settings.py` | `/api/settings/*` | Azure Speechã€Asteriskã€Difyè¨­å®š |
| `tags.py` | `/api/tags/*` | ã‚¿ã‚°CRUD |
| `tenants.py` | `/api/tenants/*` | ãƒ†ãƒŠãƒ³ãƒˆç®¡ç† |

### èµ·å‹•æ–¹æ³•

```bash
# ä»®æƒ³ç’°å¢ƒä½œæˆãƒ»æœ‰åŠ¹åŒ–
python -m venv venv
source venv/bin/activate  # macOS/Linux
.\venv\Scripts\Activate.ps1  # Windows

# ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### ç’°å¢ƒå¤‰æ•° (`.env`)

```env
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
POSTGRES_HOST=localhost
POSTGRES_USER=voiceai
POSTGRES_PASSWORD=your_password
POSTGRES_DB=voiceai

# Azure Speech Services
AZURE_SPEECH_KEY=your_azure_key
AZURE_SPEECH_REGION=japaneast

# Dify AI
DIFY_API_KEY=your_dify_key
DIFY_ENDPOINT=https://api.dify.ai/v1

# Google Cloud Visionï¼ˆFAX OCRï¼‰
GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“èªè¨¼
BACKEND_AUTH_TOKEN=your-secure-token
```

### ä¸»è¦ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

```txt
fastapi==0.115.0                              # Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
uvicorn==0.32.0                               # ASGIã‚µãƒ¼ãƒãƒ¼
asyncpg>=0.30.0                               # PostgreSQLéåŒæœŸãƒ‰ãƒ©ã‚¤ãƒãƒ¼
azure-cognitiveservices-speech==1.40.0        # Azure Speech SDK
silero-vad==5.1.2                             # éŸ³å£°æ´»å‹•æ¤œå‡º
torch>=2.0.0                                  # PyTorchï¼ˆVADç”¨ï¼‰
google-cloud-vision==3.8.0                    # Google Cloud Vision OCR
httpx==0.27.2                                 # éåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
pydantic==2.9.2                               # ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
python-jose[cryptography]==3.3.0              # JWTèªè¨¼
```

---

## 3. âš›ï¸ Next.js Frontend (UIå±¤)

### é…ç½®å ´æ‰€
```
app/ (ãƒšãƒ¼ã‚¸)
components/ (ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)
```

### è²¬å‹™
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¡¨ç¤º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šè©±ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- é¡§å®¢ãƒ»FAXãƒ»ãƒŠãƒ¬ãƒƒã‚¸ç®¡ç†ç”»é¢
- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šç”»é¢
- WebSocketã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
app/                            # Next.js App Router ãƒšãƒ¼ã‚¸
â”œâ”€â”€ page.tsx                    # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆãƒ«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ï¼‰
â”œâ”€â”€ layout.tsx                  # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ globals.css                 # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚
â”œâ”€â”€ calls/                      # é€šè©±é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ monitor/
â”‚   â”‚   â””â”€â”€ page.tsx           # é€šè©±ãƒ¢ãƒ‹ã‚¿ãƒ¼
â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â””â”€â”€ page.tsx           # AIæ¶é›»
â”‚   â””â”€â”€ history/
â”‚       â”œâ”€â”€ page.tsx           # é€šè©±å±¥æ­´ä¸€è¦§
â”‚       â””â”€â”€ [id]/page.tsx      # é€šè©±è©³ç´°
â”‚
â”œâ”€â”€ fax/
â”‚   â””â”€â”€ page.tsx               # FAXç®¡ç†
â”‚
â”œâ”€â”€ knowledge/
â”‚   â””â”€â”€ page.tsx               # ãƒŠãƒ¬ãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”‚
â”œâ”€â”€ users/                      # é¡§å®¢ç®¡ç†
â”‚   â”œâ”€â”€ page.tsx               # é¡§å®¢ä¸€è¦§
â”‚   â”œâ”€â”€ loading.tsx            # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
â”‚   â””â”€â”€ error.tsx              # ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
â”‚
â”œâ”€â”€ settings/
â”‚   â””â”€â”€ page.tsx               # ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
â”‚
â””â”€â”€ notifications/
    â””â”€â”€ page.tsx               # é€šçŸ¥è¨­å®š

components/                     # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ ui/                         # shadcn/ui UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆ49å€‹ï¼‰
â”‚   â”œâ”€â”€ button.tsx
â”‚   â”œâ”€â”€ card.tsx
â”‚   â”œâ”€â”€ dialog.tsx
â”‚   â”œâ”€â”€ input.tsx
â”‚   â”œâ”€â”€ table.tsx
â”‚   â””â”€â”€ ... (ä»–45å€‹)
â”‚
â”œâ”€â”€ calls/                      # é€šè©±é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ monitor.tsx            # é€šè©±ãƒ¢ãƒ‹ã‚¿ãƒ¼æœ¬ä½“
â”‚   â”œâ”€â”€ monitor-api.tsx        # ãƒ¢ãƒ‹ã‚¿ãƒ¼APIçµ±åˆ
â”‚   â”œâ”€â”€ call-list.tsx          # é€šè©±ãƒªã‚¹ãƒˆ
â”‚   â”œâ”€â”€ session-detail.tsx     # ã‚»ãƒƒã‚·ãƒ§ãƒ³è©³ç´°
â”‚   â”œâ”€â”€ chat-interface.tsx     # ãƒãƒ£ãƒƒãƒˆUI
â”‚   â”œâ”€â”€ history.tsx            # å±¥æ­´è¡¨ç¤º
â”‚   â””â”€â”€ history-api.tsx        # å±¥æ­´APIçµ±åˆ
â”‚
â”œâ”€â”€ dashboard/                  # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
â”‚   â”œâ”€â”€ overview.tsx
â”‚   â”œâ”€â”€ recent-calls.tsx
â”‚   â”œâ”€â”€ stats-card.tsx
â”‚   â””â”€â”€ ... (ä»–5å€‹)
â”‚
â”œâ”€â”€ fax/                        # FAXç®¡ç†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ fax-list.tsx
â”‚
â”œâ”€â”€ knowledge/                  # ãƒŠãƒ¬ãƒƒã‚¸DBã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ article-list.tsx
â”‚   â””â”€â”€ inquiry-list.tsx
â”‚
â”œâ”€â”€ users/                      # é¡§å®¢ç®¡ç†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ customer-list.tsx
â”‚   â””â”€â”€ customer-form.tsx
â”‚
â”œâ”€â”€ settings/                   # è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ azure-settings.tsx
â”‚   â”œâ”€â”€ asterisk-settings.tsx
â”‚   â”œâ”€â”€ dify-settings.tsx
â”‚   â””â”€â”€ ... (ä»–8å€‹)
â”‚
â”œâ”€â”€ notifications/              # é€šçŸ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ notification-settings.tsx
â”‚
â”œâ”€â”€ tenants/                    # ãƒ†ãƒŠãƒ³ãƒˆç®¡ç†
â”‚   â””â”€â”€ tenant-list.tsx
â”‚
â””â”€â”€ layout/                     # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â””â”€â”€ sidebar.tsx

lib/                            # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â””â”€â”€ utils.ts                    # cn()ç­‰ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

```
/ (ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)
â”œâ”€â”€ package.json                # Node.jsä¾å­˜é–¢ä¿‚
â”œâ”€â”€ package-lock.json           # ä¾å­˜é–¢ä¿‚ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ tsconfig.json               # TypeScriptè¨­å®š
â”œâ”€â”€ next.config.js              # Next.jsè¨­å®š
â”œâ”€â”€ tailwind.config.ts          # Tailwind CSSè¨­å®š
â”œâ”€â”€ postcss.config.js           # PostCSSè¨­å®š
â”œâ”€â”€ .env.local                  # ç’°å¢ƒå¤‰æ•°ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰URLï¼‰
â””â”€â”€ .eslintrc.json              # ESLintè¨­å®š
```

### èµ·å‹•æ–¹æ³•

```bash
# ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
npm run build
npm run start
```

### ç’°å¢ƒå¤‰æ•° (`.env.local`)

```env
NEXT_PUBLIC_BACKEND_URL=http://localhost:8000
NEXT_PUBLIC_NODE_BACKEND_URL=http://localhost:3001
NEXT_PUBLIC_WS_URL=ws://localhost:3001
```

### ä¸»è¦ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

```json
{
  "dependencies": {
    "next": "13.5.1",                          // Next.jsãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
    "react": "18.2.0",                         // React
    "react-dom": "18.2.0",                     // React DOM
    "typescript": "5.2.2",                     // TypeScript

    // UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    "@radix-ui/react-*": "^1.x.x",            // Radix UI primitivesï¼ˆ20å€‹ï¼‰
    "lucide-react": "^0.446.0",               // ã‚¢ã‚¤ã‚³ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
    "class-variance-authority": "^0.7.0",      // ãƒãƒªã‚¢ãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ç®¡ç†
    "clsx": "^2.1.1",                         // ã‚¯ãƒ©ã‚¹åãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    "tailwind-merge": "^2.5.2",               // Tailwindçµåˆ

    // ãƒ•ã‚©ãƒ¼ãƒ 
    "react-hook-form": "^7.53.0",             // ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç†
    "@hookform/resolvers": "^3.9.0",          // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    "zod": "^3.23.8",                         // ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

    // ãã®ä»–
    "date-fns": "^3.6.0",                     // æ—¥ä»˜å‡¦ç†
    "recharts": "^2.12.7",                    // ãƒãƒ£ãƒ¼ãƒˆæç”»
    "sonner": "^1.5.0",                       // ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥

    // ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
    "tailwindcss": "3.3.3",                   // Tailwind CSS
    "tailwindcss-animate": "^1.0.7",          // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    "autoprefixer": "10.4.15",                // CSSãƒ™ãƒ³ãƒ€ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
    "postcss": "8.4.30"                       // CSSå‡¦ç†
  }
}
```

### TypeScriptè¨­å®š (`tsconfig.json`)

```json
{
  "compilerOptions": {
    "target": "es5",
    "lib": ["dom", "dom.iterable", "esnext"],
    "strict": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "jsx": "preserve",
    "paths": {
      "@/*": ["./*"]                          // ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹
    }
  }
}
```

---

## 4. å±¤é–“é€šä¿¡ãƒ•ãƒ­ãƒ¼

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ“ é›»è©±å›ç·š / SIPãƒˆãƒ©ãƒ³ã‚¯                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ SIP/RTP
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Asterisk PBX (é€šè©±åˆ¶å¾¡)                         â”‚
â”‚          Port: 5060 (SIP), 8088 (ARI)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ ARI (WebSocket + REST)
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ğŸŸ¢ Node.js Backend (Asteriskçµ±åˆå±¤)               â”‚
â”‚       Directory: asterisk-backend/                      â”‚
â”‚       Port: 3001                                        â”‚
â”‚                                                          â”‚
â”‚  âœ… ARI Clientï¼ˆé€šè©±åˆ¶å¾¡ï¼‰                              â”‚
â”‚  âœ… Call Handlerï¼ˆç€ä¿¡ãƒ»ç™ºä¿¡å‡¦ç†ï¼‰                      â”‚
â”‚  âœ… WebSocket Managerï¼ˆPython/Frontendé€£æºï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ REST + WebSocket        â”‚ WebSocket
           â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ Python Backend    â”‚    â”‚ âš›ï¸ Next.js Frontend  â”‚
â”‚   (AIå‡¦ç†å±¤)         â”‚    â”‚   (UIå±¤)             â”‚
â”‚                      â”‚    â”‚                      â”‚
â”‚ Directory:           â”‚    â”‚ Directory:           â”‚
â”‚ - / (ãƒ«ãƒ¼ãƒˆ)         â”‚    â”‚ - app/               â”‚
â”‚ - api/               â”‚    â”‚ - components/        â”‚
â”‚                      â”‚    â”‚                      â”‚
â”‚ Port: 8000           â”‚    â”‚ Port: 3000           â”‚
â”‚                      â”‚    â”‚                      â”‚
â”‚ âœ… Azure STT/TTS     â”‚    â”‚ âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰    â”‚
â”‚ âœ… Dify AIçµ±åˆ      â”‚    â”‚ âœ… é€šè©±ãƒ¢ãƒ‹ã‚¿ãƒ¼      â”‚
â”‚ âœ… VADæ¤œå‡º          â”‚    â”‚ âœ… é¡§å®¢ç®¡ç†          â”‚
â”‚ âœ… FAXå‡¦ç†          â”‚    â”‚ âœ… ãƒŠãƒ¬ãƒƒã‚¸DB        â”‚
â”‚ âœ… PostgreSQL       â”‚    â”‚ âœ… ã‚·ã‚¹ãƒ†ãƒ è¨­å®š      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL 15+      â”‚
â”‚  - é€šè©±ãƒ­ã‚°          â”‚
â”‚  - é¡§å®¢ãƒ‡ãƒ¼ã‚¿        â”‚
â”‚  - ãƒŠãƒ¬ãƒƒã‚¸DB        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«

| æ¥ç¶š | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ç”¨é€” |
|-----|-----------|------|
| Asterisk â†” Node.js | WebSocket + REST (ARI) | é€šè©±åˆ¶å¾¡ã€ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ |
| Node.js â†” Python | WebSocket + REST | éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€é€šè©±æƒ…å ± |
| Node.js â†” Frontend | WebSocket | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šè©±çŠ¶æ…‹é€šçŸ¥ |
| Frontend â†” Python | REST API | ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ›´æ–° |
| Python â†” PostgreSQL | asyncpg | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ |

---

## 5. é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### ä¸€æ‹¬èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰

```bash
# PowerShellï¼ˆWindowsï¼‰
.\start-all-services.ps1

# Bashï¼ˆmacOS/Linuxï¼‰
./start-all-services.sh
```

### å€‹åˆ¥èµ·å‹•

```bash
# Terminal 1: Python Backend
source venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8000 --reload

# Terminal 2: Node.js Backend
cd asterisk-backend
npm run dev

# Terminal 3: Frontend
npm run dev
```

### ã‚¢ã‚¯ã‚»ã‚¹URL

- **Frontend**: http://localhost:3000
- **Python API Docs**: http://localhost:8000/docs
- **Node.js Health**: http://localhost:3001/health

---

## 6. ãƒ•ã‚¡ã‚¤ãƒ«æ•°çµ±è¨ˆ

| å±¤ | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«æ•° | è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ•° |
|----|------------|--------------|--------------|
| ğŸŸ¢ Node.js Backend | `asterisk-backend/` | 7å€‹ | 4å€‹ |
| ğŸ Python Backend | `/` + `api/` | 15å€‹ | 2å€‹ |
| âš›ï¸ Next.js Frontend | `app/` + `components/` | 80+å€‹ | 6å€‹ |

### UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

- **shadcn/uiåŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: 49å€‹ï¼ˆ`components/ui/`ï¼‰
- **ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: 30+å€‹
- **ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: 15+å€‹

---

## 7. ã¾ã¨ã‚

### å„å±¤ã®ç‰¹å¾´

| å±¤ | è¨€èª/FW | ä¸»ãªè²¬å‹™ | ãƒãƒ¼ãƒˆ |
|----|---------|----------|--------|
| **ğŸŸ¢ Node.js Backend** | Node.js + Express | Asteriskçµ±åˆã€é€šè©±åˆ¶å¾¡ | 3001 |
| **ğŸ Python Backend** | Python + FastAPI | AIå‡¦ç†ã€DBç®¡ç†ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ | 8000 |
| **âš›ï¸ Next.js Frontend** | TypeScript + Next.js + React | UIè¡¨ç¤ºã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ | 3000 |

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¦‹åˆ†ã‘æ–¹

1. **`asterisk-backend/`ãŒå­˜åœ¨** â†’ Node.js Backend
2. **`main.py`ãŒãƒ«ãƒ¼ãƒˆã«ã‚ã‚‹** â†’ Python Backend
3. **`app/`ã¨`components/`ãŒä¸¦ã‚“ã§ã„ã‚‹** â†’ Next.js Frontend

### é–‹ç™ºæ™‚ã®æ³¨æ„ç‚¹

- å„å±¤ã¯ç‹¬ç«‹ã—ã¦èµ·å‹•ãƒ»åœæ­¢å¯èƒ½
- ç’°å¢ƒå¤‰æ•°ï¼ˆ`.env`ï¼‰ã¯å„å±¤ã§å€‹åˆ¥ã«è¨­å®š
- WebSocketæ¥ç¶šãŒåˆ‡ã‚Œã‚‹ã¨æ©Ÿèƒ½ãŒåˆ¶é™ã•ã‚Œã‚‹
- ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œã®ãŸã‚ã€å…¨APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«`tenant_id`ãŒå¿…è¦
